<REDACTED FOR LENGTH - See previous assistant message for full code>