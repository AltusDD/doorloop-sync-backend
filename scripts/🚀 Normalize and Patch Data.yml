import os
import sys

# 🔒 Empire-Grade Override: Set absolute path to project root
CURRENT_FILE_DIR = os.path.dirname(os.path.abspath(__file__))
PROJECT_ROOT = os.path.abspath(os.path.join(CURRENT_FILE_DIR, ".."))
sys.path.insert(0, PROJECT_ROOT)

# ✅ Now your import works no matter what
from sync_pipeline.normalize_properties import normalize_properties
from sync_pipeline.normalize_units import normalize_units
from sync_pipeline.normalize_leases import normalize_leases
from sync_pipeline.normalize_tenants import normalize_tenants
from sync_pipeline.normalize_owners import normalize_owners

def main():
    print("🚀 Starting Normalize and Patch All")

    try:
        normalize_properties()
        print("✅ Properties normalized")

        normalize_units()
        print("✅ Units normalized")

        normalize_leases()
        print("✅ Leases normalized")

        normalize_tenants()
        print("✅ Tenants normalized")

        normalize_owners()
        print("✅ Owners normalized")

        print("🎉 Normalization and patch complete")

    except Exception as e:
        print(f"❌ Normalization failed: {e}")
        raise e

if __name__ == "__main__":
    main()
