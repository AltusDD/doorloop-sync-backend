import os
import sys

# ğŸ” Crawl upward until we find the project root that contains 'sync_pipeline'
current = os.path.abspath(__file__)
while True:
    current = os.path.dirname(current)
    if "sync_pipeline" in os.listdir(current):
        sys.path.insert(0, current)
        break
    if current == "/" or current == "":
        raise Exception("âŒ Could not find 'sync_pipeline' directory in any parent path.")

# âœ… Now your imports will work correctly
from sync_pipeline.normalize_properties import normalize_properties
from sync_pipeline.normalize_units import normalize_units
from sync_pipeline.normalize_leases import normalize_leases
from sync_pipeline.normalize_tenants import normalize_tenants
from sync_pipeline.normalize_owners import normalize_owners

def main():
    print("ğŸš€ Starting Normalize and Patch All")

    try:
        normalize_properties()
        print("âœ… Properties normalized")

        normalize_units()
        print("âœ… Units normalized")

        normalize_leases()
        print("âœ… Leases normalized")

        normalize_tenants()
        print("âœ… Tenants normalized")

        normalize_owners()
        print("âœ… Owners normalized")

        print("ğŸ‰ All normalization steps completed successfully")

    except Exception as e:
        print(f"âŒ Normalization failed: {e}")
        raise e

if __name__ == "__main__":
    main()
